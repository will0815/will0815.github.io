<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <meta name="description" content="Will go, Just do it.">
  <meta name="author" content="Will.Quan">
  <meta name="keywords" content="DB Index, willgo, Will.Quan">
  <title>DB Index - willgo</title>
  <link rel="canonical" href="index.html/blog/2014/09/27/DB-Index.html">
  <link rel="icon" href="/res/img/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="/res/img/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="/res/css/public.css">
  <link rel="stylesheet" href="/res/css/light.css">
  <script src="/res/js/light.js"></script>
  <script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?will_go8";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>
</head>
<body>
  <div id="blog">
    <div class="sidebar">
  <div class="profilepic">
    <a href="/"><img src="/res/img/icon.png" alt="logo"></img></a>
  </div>
  <h1 class="title"><a href="/">willgo</a></h1>
  <h2 class="sub-title">最好的从未错过</h2>
  <nav id="nav">
    <ul>
    
      <li><a href="/page/timing.html"><i class="fa fa-clock-o"></i>&nbsp;时间轴</a></li>
    
      <li><a href="/page/category.html"><i class="fa fa-tags"></i>&nbsp;分类</a></li>
    
      <li><a href="/page/read.html"><i class="fa fa-book"></i>&nbsp;阅读</a></li>
    
      <li><a href="/life/index.html"target="_blank"><i class="fa fa-eyedropper"></i>&nbsp;记录</a></li>
    
      <li><a href="/page/about.html"><i class="fa fa-paper-plane-o"></i>&nbsp;关于</a></li>
    
    </ul>
  </nav>  
  <nav id="sub-nav">
    <a class="weibo " href="http://weibo.com/u/2369015654" title="新浪微博" target="_blank"><i class="fa fa-weibo"></i></a>
    <a class="github" href="https://github.com/will0815/will0815.github.io" title="GitHub" target="_blank"><i class="fa fa-github fa-2x"></i></a>
    <a class="rss" href="/page/feed.xml" title="RSS订阅" target="_blank"><i class="fa fa-rss"></i></a>
  </nav>
  <div id="license">
    <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" target="_blank" title="本站所有作品采用：&#10;知识共享《署名 非商业性使用 相同方式共享 3.0》&#10;进行许可" >
    <img alt="License" height="31" width="88" src="/res/img/license.png" /></a>
  </div>
</div>
    <div class="main">
    <header class="post-header">
  <h1 class="post-title"><a href="/blog/2014/09/27/DB-Index.html">DB Index</a></h2>
  <p class="post-meta">
    <i class="fa fa-calendar"></i>
    2014年09月27日
    <i class="space"></i>
    <i class="fa fa-tags"></i>
    <a class="post-category" href="/page/category.html#db">db</a>	
  </p>
</header>
<div class="post-main">
<p>理解索引结构     </p>

<p>实际上，可以把索引理解为一种特殊的目录。微软的SQL SERVER提供了两种索引：聚集索引（clustered index，也称聚类索引、簇集索引）和非聚集索引（nonclustered index，也称非聚类索引、非簇集索引）。下面，我们举例来说明一下聚集索引和非聚集索引的区别： </p>

<p>其实，我们的汉语字典的正文本身就是一个聚集索引。比如，我们要查”安”字，就会很自然地翻开字典的前几页，因为”安”的拼音是”an”，而按照拼音排序汉字的字典是以英文字母”a”开头并以”z”结尾的，那么”安”字就自然地排在字典的前部。如果您翻完了所有以”a”开头的部分仍然找不到这个字，那么就说明您的字典中没有这个字；同样的，如果查”张”字，那您也会将您的字典翻到最后部分，因为”张”的拼音是”zhang”。也就是说，字典的正文部分本身就是一个目录，您不需要再去查其他目录来找到您需要找的内容。  </p>

<p>我们把这种正文内容本身就是一种按照一定规则排列的目录称为”聚集索引”。      </p>

<p>如果您认识某个字，您可以快速地从自动中查到这个字。但您也可能会遇到您不认识的字，不知道它的发音，这时候，您就不能按照刚才的方法找到您要查的字，而需要去根据”偏旁部首”查到您要找的字，然后根据这个字后的页码直接翻到某页来找到您要找的字。但您结合”部首目录”和”检字表”而查到的字的排序并不是真正的正文的排序方法，比如您查”张”字，我们可以看到在查部首之后的检字表中”张”的页码是672页，检字表中”张”的上面是”驰”字，但页码却是63页，”张”的下面是”弩”字，页面是390页。很显然，这些字并不是真正的分别位于”张”字的上下方，现在您看到的连续的”驰、张、弩”三字实际上就是他们在非聚集索引中的排序，是字典正文中的字在非聚集索引中的映射。我们可以通过这种方式来找到您所需要的字，但它需要两个过程，先找到目录中的结果，然后再翻到您所需要的页码。 </p>

<p>我们把这种目录纯粹是目录，正文纯粹是正文的排序方式称为”非聚集索引”。 </p>

<p>何时使用聚集索引或非聚集索引    <br />
下面的表总结了何时使用聚集索引或非聚集索引（很重要）。   </p>

<pre><code>	动作描述        使用聚集索引 使用非聚集索引     
	列经常被分组排序      应        应     
	返回某范围内的数据          应      不应        
	一个或极少不同值           不应     不应     
	小数目的不同值                应     不应     
	大数目的不同值              不应    应     
	频繁更新的列                 不应   应     
	外键列                  应 应     
	主键列               应   应     
	频繁修改索引列       不应      应        
</code></pre>

<p>几种常见的MySQL索引类型。</p>

<ol>
  <li>
    <p>普通型索引
 这是最基本的索引类型，而且它没有唯一性之类的限制。普通索引可以通过以下几种方式创建： </p>
  </li>
  <li>创建索引，例如CREATE INDEX 索引的名字 ON tablename (列名1，列名2,…); </li>
  <li>修改表，例如ALTER TABLE tablename ADD INDEX 索引的名字 (列名1，列名2,…); </li>
  <li>创建表的时候指定索引，例如CREATE TABLE tablename ( […], INDEX 索引的名字 (列名1，列名
2,…) );</li>
  <li>
    <p>唯一索引
   这种索引和前面的“普通索引”基本相同，但有一个区别：索引列的所有值都只能出现一次，即必须唯一。唯一性索引可以用以下几种方式创建： </p>
  </li>
  <li>创建索引，例如CREATE UNIQUE INDEX 索引的名字 ON tablename (列的列表); </li>
  <li>修改表，例如ALTER TABLE tablename ADD UNIQUE 索引的名字 (列的列表); </li>
  <li>
    <p>创建表的时候指定索引，例如CREATE TABLE tablename ( […], UNIQUE 索引的名字 (列的列
     表) );</p>
  </li>
  <li>
    <p>主键</p>

    <p>主键是一种唯一性索引，但它必须指定为“PRIMARY KEY”。如果你曾经用过AUTO_INCREMENT类型的列，你可能已经熟悉主键之类的概念了。主键一般在创建表的时候指定，例如“CREATE TABLE tablename ( […], PRIMARY KEY (列的列表) ); ”。但是，我们也可以通过修改表的方式加入主键，例如“ALTER TABLE tablename ADD PRIMARY KEY (列的列表); ”。每个表只能有一个主键。 （主键相当于聚合索引，是查找最快的索引）</p>
  </li>
  <li>
    <p>单列索引和多列索引</p>

    <p>索引可以是单列索引，也可以是多列索引。
 1. 单列索引就是常用的一个列字段的索引，常见的索引。
 2. 多列索引就是含有多个列字段的索引</p>

    <pre><code> 	 alter table student add index sy(name,age，score);
 	 索引sy就为多列索引，多列索引在以下几中情况下才能有效：
 	 select * from student where name='jia' and age&gt;='12' //where条件中含有索引的首列字段和
		   第二个字段
 	 select * from student where name='jia' //where条件中只含有首列字段
 	 select * from student where name='jia' and score&lt;60//where条件中含有首列字段和第三个字
		  段
		 总结：多列索引只有在where条件中含有索引中的首列字段时才有效
</code></pre>
  </li>
  <li>
    <p>选择索引列</p>

    <p>应该怎样选择索引列，首先要看查询条件，一般将查询条件中的列作为索引</p>
  </li>
</ol>

<p><strong>联合索引使用结论:</strong></p>

<ol>
  <li>查询条件中出现联合索引第一列,或者全部,则能利用联合索引.</li>
  <li>条件列中只要条件相连在一起,以本文例子来说就是:
last_name=’1′ and first_name=’1′与first_name=’1′ and last_name=’1′
,无论前后,都会利用上联合索引.</li>
  <li>查询条件中没有出现联合索引的第一列,而出现联合索引的第二列,或者第三列,都不会利用联合索引查询.</li>
</ol>

<p><strong>单一列索引的应用结论:</strong></p>

<p>只要条件列中出现索引列,无论在什么位置,都能利用索引查询.</p>

<p><strong>两者的共同点:</strong></p>

<ol>
  <li>要想利用索引,都要符合SARG标准.</li>
  <li>都是为了提高查询速度.</li>
  <li>都需要额外的系统开销,磁盘空间.</li>
</ol>

<p>补充说明: stmtText信息来产生,在查询语句前面加上:SET STATISTICS PROFILE on.可以通过运行它,来观察你的查询是否合理,这样才能真正做到优化.</p>

<p><strong>主旨:讨论什么情况下能利用上索引.</strong></p>

<p>索引:创建索引可以根据查询业务的不同分为两种:单一列的索引,联合索引. 顾名思义,单一列索引就是指在表的某一列上创建索引,联合索引是在多个列上联合创建索引.</p>

<p>优缺点比较:</p>

<ol>
  <li>索引所占用空间:单一列索引相对要小.</li>
  <li>索引创建时间:单一列索引相对短.</li>
  <li>索引对insert,update,delete的影响程序:单一列索引要相对低.</li>
  <li>在多条件查询时,联合索引效率要高.</li>
</ol>

<p>索引的使用范围:单一列索引可以出现在where 条件中的任何位置,而联合索引需要按一定的顺序来写. </p>


</div>
<div class="share">
  <div class="bdsharebuttonbox">
    <a href="#" class="bds_more" data-cmd="more"></a>
    <a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a>
    <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
  </div>
  <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":["qzone","tsina","weixin","sqq"],"bdPic":"","bdStyle":"0","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/res/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
</div>
<div class="pagination">

<a class="pagination-item newer" href="/blog/2014/09/27/AMD--CMD.html"><i class="fa fa-arrow-left"></i>&nbsp;&nbsp;AMD & CMD</a>


<a class="pagination-item older" href="/blog/2014/09/27/Dflinux.html">Df命令linux系统以磁盘&nbsp;&nbsp;<i class="fa fa-arrow-right"></i></a>

</div>
<div class="comments">
  <div class="ds-thread" data-title="DB Index" data-thread-key="/blog/2014/09/27/DB-Index" data-url="index.html/blog/2014/09/27/DB-Index.html"></div>
  <script type="text/javascript">var duoshuoQuery = {short_name:"5312914"};(function(){var ds = document.createElement('script');ds.type = 'text/javascript';ds.async = true;ds.src = '/res/js/embed.js';ds.charset = 'UTF-8';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);})();</script>
</div>
    <footer>Copyright&nbsp;&copy;&nbsp;2014 <a href="index.html">willgo</a><br/><i class="fa fa-cogs" style="color:blueviolet;">&nbsp;</i>Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a></footer>
    </div>
  </div>    
  <div id="top"><a id="rocket" href="javascript:;" title="返回顶部"><i></i></a></div>
  
</body>
</html>